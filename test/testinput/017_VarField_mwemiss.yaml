window begin: 2019-12-29T21:00:00Z
window end: 2019-12-30T03:00:00Z

observations:
  - obs operator:
       name: RTTOV
       GeoVal_type: MetO # default
       Debug: false # default
       Absorbers: [Water_vapour]
       linear obs operator:
         Absorbers: [Water_vapour]
       obs options:
         RTTOV_default_opts: UKMO_PS43 # non-default
         RTTOV_apply_reg_limits: true # for compatibility with previous
                                      # version of this test
         SatRad_compatibility: true # default
         InspectProfileNumber: 1
         Sensor_ID: noaa_20_atms
         CoefficientPath: Data/rttov7pred54L/
         UseRHwaterForQC: true # default
         UseColdSurfaceCheck: true # default
         prof_by_prof: false # default
    obs space:
      name: ATMS
      obsdatain:
        obsfile: Data/atms_n20_obs_20191230T0000_017_VarField_mwemiss.nc4
      simulated variables: [brightness_temperature]
      channels: 1-5
    geovals:
      filename: Data/geovals_atms_20191230T0000Z_017_VarField_mwemiss.nc4
    obs filters:
    - filter: BlackList
      filter variables:
      - name: brightness_temperature
        channels: 1-2
    - filter: BlackList
      filter variables:
      - name: brightness_temperature
        channels: 1-5
      where:
      - variable:
          name: sequence_number@MetaData
        minvalue: 4.0
    - filter: VarObs Writer
      reject_obs_with_all_variables_failing_qc: true
      namelist_directory: testinput/VarObsWriterNamelists_017_VarField_mwemiss
      general_mode: debug
    - filter: VarObs Checker
      expected_main_table_columns:
      # In arrays below, rows denote locations and columns channels
        field:    ["17", "17", "17", "17", "17", 
                   "17", "17", "17", "17", "17"]
        ob value: ["0.95000", "0.95000", "0.95000", "0.95000", "0.95000", 
                   "0.95000", "0.95000", "0.95000", "0.95000", "0.95000"]
        lat:      ["61.10410", "61.10410", "61.10410", "61.10410", "61.10410", 
                   "61.81990", "61.81990", "61.81990", "61.81990", "61.81990"]
    benchmarkFlag: 1000 # just to keep the ObsFilters test happy
    flaggedBenchmark: 0
